<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
    <title>Crash TON</title>
    <link rel="icon" href="/public/icon.png" />

    <style>
      :root{
        --bg1:#0b1230; --bg2:#0e1540;
        --panel:#0d1435; --panel2:#0b1230;
        --muted:#9fb3d9; --text:#eef3ff;
        --accent:#5c7cff; --accent-2:#12eab8; --danger:#ff4d5a;
        --border:rgba(255,255,255,.08);
        /* será atualizado via JS para caber no Telegram */
        --graph-h: 460px;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      html,body{margin:0; padding:0; overflow:hidden} /* evita “desformatar” no miniapp */
      body{
        color:var(--text);
        font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
        background: radial-gradient(1200px 600px at 60% -10%, rgba(96,122,255,.18), transparent),
                    radial-gradient(900px 500px at 20% 10%, rgba(18,234,184,.08), transparent),
                    linear-gradient(180deg, var(--bg1), var(--bg2));
      }

      .wrap{max-width:1320px;margin:0 auto;padding:12px} /* padding menor pro miniapp */
      .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
      .brand{display:flex;align-items:center;gap:10px;font-weight:800;font-size:16px}
      .brand .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg,#20df70,#12eab8)}
      .saldo{color:var(--muted)} .saldo strong{color:#fff;margin-left:6px}

      .main{display:grid;grid-template-columns:1fr;gap:12px}

      .game-card{
        background:linear-gradient(180deg,rgba(22,28,68,.8),rgba(13,20,53,.85));
        border:1px solid var(--border); border-radius:14px; overflow:hidden;
        box-shadow:0 10px 40px rgba(0,0,0,.35);
      }

      .trends{display:flex;gap:12px;padding:10px 12px;border-bottom:1px solid var(--border);}
      .dot{width:8px;height:8px;border-radius:50%; background:#7ea0ff; box-shadow:0 0 0 4px rgba(124,155,255,.12);}

      .graph-area{position:relative;padding:12px}
      .graph{
        height:var(--graph-h); border-radius:12px;
        background:linear-gradient(180deg,#0b1230,#0a112b);
        border:1px solid var(--border);
        position:relative; overflow:hidden;
      }
      .mult-big{
        position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
        font-size:64px; font-weight:900; letter-spacing:-1px;
        text-shadow:0 8px 40px rgba(92,124,255,.35), 0 2px 0 rgba(0,0,0,.35);
        pointer-events:none; white-space:nowrap;
      }

      .controls{
        display:grid; grid-template-columns:1fr; gap:12px;
        align-items:center; padding:12px; background:rgba(8,14,36,.66);
        border-top:1px solid var(--border);
      }
      .ctrl-row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
      .switch{display:flex;align-items:center;gap:8px;color:var(--muted);user-select:none}
      .switch input{accent-color:var(--accent)}

      .field{display:flex;flex-direction:column;gap:6px; min-width:160px; flex:1}
      .label{font-size:12px;color:var(--muted)}
      .input{
        background:var(--panel2); border:1px solid var(--border); color:#fff;
        border-radius:10px; padding:10px 12px; font-size:14px; outline:none; width:100%;
      }

      .quick{display:flex;gap:6px}
      .quick button{
        background:#0e173a;border:1px solid var(--border);color:#dfe8ff;
        padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:700; min-width:54px;
      }

      .cta-row{display:flex; gap:10px}
      .cta{
        font-weight:800; letter-spacing:.3px; cursor:pointer; border-radius:14px;
        padding:14px 22px; border:none; color:#fff; background:var(--accent);
        box-shadow:0 10px 30px rgba(92,124,255,.35); flex:1;
      }
      .cta:disabled{opacity:.6; cursor:not-allowed}
      .cashout{background:var(--accent-2); box-shadow:0 10px 30px rgba(18,234,184,.28)}
      .danger{background:var(--danger); box-shadow:0 10px 30px rgba(255,77,90,.28)}

      .statusbar{display:flex;justify-content:space-between;align-items:center;color:var(--muted);
        padding:10px 12px;border-top:1px solid var(--border);background:rgba(8,14,36,.5)}
      .pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:#121a44;color:#9fb3d9;border:1px solid var(--border)}

      @media (min-width: 860px){
        .controls{grid-template-columns: auto 1fr auto}
        .cta-row{width:auto}
        .cta{flex:0 0 auto; min-width:140px}
        .mult-big{font-size:84px}
      }
    </style>

    <!-- PHASER -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.50.1/dist/phaser.min.js"></script>
    <!-- Telegram WebApp JS (para medir viewport se disponível) -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
  </head>
  <body>
    <div class="wrap">
      <div class="topbar">
        <div class="brand"><span class="dot"></span><span>Crash TON</span></div>
        <div class="saldo">Saldo: <strong id="balance">—</strong></div>
      </div>

      <section class="game-card" id="gameCard">
        <div class="trends" id="trendsBar"></div>

        <div class="graph-area">
          <div id="graph" class="graph">
            <div id="bigMult" class="mult-big">1.00×</div>
            <div id="phaser-root" style="width:100%;height:100%"></div>
          </div>
        </div>

        <div class="controls">
          <div class="switch"><input id="modeSwitch" type="checkbox"/> <span>MANUAL</span></div>

          <div class="ctrl-row">
            <div class="field">
              <span class="label">BET AMOUNT</span>
              <input id="betAmount" class="input" type="number" min="1" step="1" value="100" />
            </div>

            <div class="quick">
              <button data-q="min">MIN</button>
              <button data-q="half">1/2</button>
              <button data-q="2x">2X</button>
              <button data-q="max">MAX</button>
            </div>

            <div class="field" style="min-width:160px">
              <span class="label">AUTO CASHOUT (×)</span>
              <input id="autoCash" class="input" type="number" min="1.01" step="0.01" placeholder="2.00" />
            </div>
          </div>

          <div class="cta-row">
            <button id="betBtn" class="cta">BET</button>
            <button id="cashoutBtn" class="cta cashout" disabled>CASHOUT</button>
          </div>
        </div>

        <div class="statusbar">
          <div id="phasePill" class="pill">Fase: <strong id="phaseTxt">idle</strong></div>
          <div class="pill">Crash desta rodada: <span id="crashTxt">—</span></div>
        </div>
      </section>
    </div>

    <script src="/_config.js"></script>
    <script src="/src/app.js"></script>
    <script src="/src/main.js"></script>
  </body>
</html>
